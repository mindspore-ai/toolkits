# Copyright 2023 Huawei Technologies Co., Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ============================================================================

# List of ops that register hooks

communication.comm_func:
  - all_reduce
  - all_gather_into_tensor
  - reduce
  - reduce_scatter_tensor
  - all_to_all_single_with_output_shape
  - all_to_all_with_output_shape
  - batch_isend_irecv
  - broadcast
  - gather_into_tensor
  - scatter_tensor
  
ops:
  - adaptive_avg_pool1d
  - adaptive_avg_pool2d
  - adaptive_avg_pool3d
  - adaptive_max_pool1d
  - adaptive_max_pool2d
  - avg_pool1d
  - avg_pool2d
  - avg_pool3d
  - batch_norm
  - bias_add
  - bidense
  - ctc_greedy_decoder
  - conv1d
  - conv2d
  - conv3d
  - deformable_conv2d
  - dense
  - dropout
  - dropout1d
  - dropout2d
  - dropout3d
  - embedding
  - flatten
  - fold
  - fractional_max_pool3d
  - group_norm
  - layer_norm
  - lp_pool1d
  - lp_pool2d
  - lrn
  - max_pool2d
  - max_pool3d
  - max_unpool1d
  - max_unpool2d
  - max_unpool3d
  - rms_norm
  - unfold
  - binary_cross_entropy
  - binary_cross_entropy_with_logits
  - cosine_embedding_loss
  - cross_entropy
  - ctc_loss
  - gaussian_nll_loss
  - hinge_embedding_loss
  - huber_loss
  - kl_div
  - l1_loss
  - margin_ranking_loss
  - mse_loss
  - multi_margin_loss
  - multilabel_margin_loss
  - multilabel_soft_margin_loss
  - nll_loss
  - smooth_l1_loss
  - soft_margin_loss
  - triplet_margin_loss
  - celu
  - elu
  - fast_gelu
  - gelu
  - glu
  - gumbel_softmax
  - hardshrink
  - hardsigmoid
  - hardswish
  - hardtanh
  - leaky_relu
  - log_softmax
  - logsigmoid
  - mish
  - prelu
  - relu
  - relu6
  - rrelu
  - selu
  - sigmoid
  - silu
  - softmax
  - softmin
  - softshrink
  - softsign
  - tanh
  - threshold
  - cdist
  - dist
  - pdist
  - choice_with_mask
  - random_categorical
  - log_uniform_candidate_sampler
  - uniform_candidate_sampler
  - affine_grid
  - bounding_box_decode
  - bounding_box_encode
  - col2im
  - check_valid
  - crop_and_resize
  - grid_sample
  - interpolate
  - iou
  - pad
  - padding
  - pixel_shuffle
  - pixel_unshuffle
  - upsample
  - abs
  - absolute
  - accumulate_n
  - acos
  - arccos
  - acosh
  - add
  - addcdiv
  - addcmul
  - addmv
  - addn
  - angle
  - arccosh
  - arcsin
  - arcsinh
  - arctan
  - arctanh
  - arctan2
  - asin
  - asinh
  - atan
  - atan2
  - atanh
  - atleast_1d
  - atleast_2d
  - atleast_3d
  - bessel_i0
  - bessel_i0e
  - bessel_i1
  - bessel_i1e
  - bessel_j0
  - bessel_j1
  - bessel_k0
  - bessel_k0e
  - bessel_k1
  - bessel_k1e
  - bessel_y0
  - bessel_y1
  - bitwise_and
  - bitwise_left_shift
  - bitwise_or
  - bitwise_right_shift
  - bitwise_xor
  - ceil
  - clamp
  - clip
  - combinations
  - copysign
  - cos
  - cosh
  - cosine_similarity
  - cov
  - diag_embed
  - diff
  - deg2rad
  - digamma
  - div
  - divide
  - erf
  - erfc
  - erfinv
  - exp
  - exp2
  - expm1
  - floor
  - floor_div
  - floor_divide
  - floor_mod
  - float_power
  - fmod
  - frac
  - gcd
  - hypot
  - igamma
  - igammac
  - imag
  - i0
  - inv
  - invert
  - lcm
  - ldexp
  - lerp
  - log
  - log2
  - log10
  - log1p
  - logaddexp
  - logaddexp2
  - logcumsumexp
  - logical_and
  - logical_not
  - logical_or
  - logical_xor
  - logit
  - mul
  - multiply
  - mvlgamma
  - neg
  - negative
  - nextafter
  - polar
  - polygamma
  - positive
  - pow
  - rad2deg
  - ravel
  - real
  - reciprocal
  - remainder
  - rot90
  - round
  - rsqrt
  - sgn
  - sign
  - signbit
  - sin
  - sinc
  - sinh
  - sqrt
  - square
  - sub
  - subtract
  - t
  - tan
  - tanhshrink
  - trapz
  - tril_indices
  - triu_indices
  - true_divide
  - trunc
  - truncate_div
  - truncate_mod
  - xdivy
  - xlogy
  - zeta
  - all
  - amax
  - amin
  - aminmax
  - any
  - argmax
  - argmin
  - cummax
  - cummin
  - cumprod
  - cumsum
  - fmax
  - histc
  - logsumexp
  - max
  - mean
  - median
  - min
  - norm
  - prod
  - std
  - std_mean
  - var
  - var_mean
  - argsort
  - approximate_equal
  - bucketize
  - equal
  - ge
  - greater
  - greater_equal
  - gt
  - intopk
  - isclose
  - isfinite
  - isinf
  - isnan
  - isneginf
  - isposinf
  - isreal
  - is_complex
  - is_floating_point
  - le
  - less
  - less_equal
  - lt
  - maximum
  - minimum
  - msort
  - ne
  - not_equal
  - searchsorted
  - topk
  - bmm
  - addbmm
  - addmm
  - baddbmm
  - addr
  - adjoint
  - cholesky
  - cholesky_solve
  - cond
  - batch_dot
  - dot
  - eigvals
  - inner
  - inverse
  - geqrf
  - ger
  - kron
  - lu_solve
  - lu_unpack
  - matmul
  - matrix_solve
  - matrix_band_part
  - matrix_diag
  - matrix_diag_part
  - matrix_set_diag
  - mm
  - mv
  - outer
  - orgqr
  - ormqr
  - pinv
  - svd
  - tensor_dot
  - vander
  - vecdot
  - logdet
  - slogdet
  - trace
  - bartlett_window
  - blackman_window
  - hamming_window
  - hann_window
  - kaiser_window
  - eps
  - eye
  - fill
  - full
  - full_like
  - linspace
  - logspace
  - one_hot
  - ones
  - ones_like
  - arange
  - range
  - zeros
  - zeros_like
  - heaviside
  - bernoulli
  - gamma
  - laplace
  - mul
  - multinomial
  - multinomial_with_replacement
  - rand
  - rand_like
  - randint
  - randint_like
  - randn
  - randn_like
  - random_gamma
  - random_poisson
  - randperm
  - standard_laplace
  - standard_normal
  - uniform
  - argwhere
  - batch_to_space_nd
  - bincount
  - block_diag
  - broadcast_to
  - cat
  - channel_shuffle
  - chunk
  - column_stack
  - concat
  - conj
  - count_nonzero
  - deepcopy
  - diag
  - diagflat
  - diagonal
  - diagonal_scatter
  - dyn_shape
  - dsplit
  - dstack
  - einsum
  - expand
  - expand_dims
  - flip
  - fliplr
  - flipud
  - gather
  - gather_d
  - gather_elements
  - gather_nd
  - hsplit
  - hstack
  - index_add
  - index_fill
  - index_select
  - inplace_add
  - inplace_index_add
  - inplace_sub
  - inplace_update
  - is_nonzero
  - masked_fill
  - masked_select
  - meshgrid
  - moveaxis
  - movedim
  - narrow
  - nan_to_num
  - nansum
  - nanmean
  - nanmedian
  - normal
  - nonzero
  - numel
  - permute
  - population_count
  - rank
  - repeat_elements
  - repeat_interleave
  - reshape
  - reverse
  - reverse_sequence
  - roll
  - row_stack
  - scatter
  - scatter_nd
  - select
  - select_scatter
  - sequence_mask
  - shuffle
  - size
  - slice
  - slice_scatter
  - sort
  - space_to_batch_nd
  - sparse_segment_mean
  - split
  - squeeze
  - stack
  - strided_slice
  - sum
  - swapaxes
  - swapdims
  - tensor_scatter_add
  - tensor_scatter_div
  - tensor_scatter_max
  - tensor_scatter_min
  - tensor_scatter_mul
  - tensor_scatter_sub
  - tensor_scatter_elements
  - tensor_split
  - tile
  - tril
  - triu
  - transpose
  - unbind
  - unique
  - unique_consecutive
  - unique_with_pad
  - unsorted_segment_max
  - unsorted_segment_min
  - unsorted_segment_prod
  - unsorted_segment_sum
  - unsqueeze
  - unstack
  - view_as_real
  - vsplit
  - vstack
  - where
  - cross
  - renorm
  - is_tensor
  - scalar_cast
  - scalar_to_tensor
  - tuple_to_array
  - clip_by_global_norm
  - clip_by_value
  - clip_by_norm
  - assign
  - assign_add
  - assign_sub
  - scatter_add
  - scatter_div
  - scatter_max
  - scatter_min
  - scatter_mul
  - scatter_nd_add
  - scatter_nd_div
  - scatter_nd_max
  - scatter_nd_min
  - scatter_nd_mul
  - scatter_nd_sub
  - scatter_update
  - derivative
  - jet

tensor:
  - __abs__
  - __add__
  - __and__
  - __bool__
  - __eq__
  - __ge__
  - __gt__
  - __iadd__
  - __ifloordiv__
  - __imatmul__
  - __imod__
  - __imul__
  - __isub__
  - __le__
  - __lt__
  - __matmul__
  - __mod__
  - __mul__
  - __ne__
  - __neg__
  - __or__
  - __pow__
  - __radd__
  - __rmatmul__
  - __rmod__
  - __rmul__
  - __rpow__
  - __rsub__
  - __sub__
  - __truediv__
  - __xor__
  - abs
  - absolute
  - acos
  - acosh
  - add
  - addbmm
  - addcdiv
  - addcmul
  - addmm
  - addmv
  - addr
  - adjoint
  - all
  - amax
  - amin
  - aminmax
  - any
  - arccos
  - arccosh
  - argmax
  - argmax_with_value
  - angle
  - approximate_equal
  - arcsin
  - arcsinh
  - arctan
  - arctanh
  - argmin
  - argsort
  - argwhere
  - asin
  - asinh
  - atan
  - atan2
  - atanh
  - baddbmm
  - bernoulli
  - bincount
  - bitwise_and
  - bitwise_left_shift
  - bitwise_or
  - bitwise_right_shift
  - bitwise_xor
  - bmm
  - bool
  - broadcast_to
  - ceil
  - cholesky_solve
  - cholesky
  - choose
  - chunk
  - clamp
  - clip
  - col2im
  - conj
  - contiguous
  - copysign
  - cos
  - cosh
  - count_nonzero
  - cov
  - cross
  - cummax
  - cummin
  - cumprod
  - cumsum
  - deg2rad
  - diag
  - diagflat
  - diff
  - digamma
  - div
  - divide
  - dot
  - dsplit
  - eigvals
  - eq
  - equal
  - erf
  - erfc
  - erfinv
  - exp
  - expand_as
  - expand_dims
  - expm1
  - fill_diagonal
  - flip
  - fliplr
  - flipud
  - float_power
  - floor
  - fold
  - fmod
  - frac
  - gather
  - gather_elements
  - gather_nd
  - ge
  - geqrf
  - ger
  - greater
  - greater_equal
  - gt
  - half
  - hardshrink
  - has_init
  - heaviside
  - histc
  - hsplit
  - hypot
  - i0
  - igamma
  - igammac
  - imag
  - index_add
  - index_fill
  - index_put
  - index_select
  - inner
  - int
  - inv
  - inverse
  - isclose
  - isfinite
  - isinf
  - isnan
  - is_complex
  - is_contiguous
  - is_floating_point
  - is_signed
  - isneginf
  - isposinf
  - isreal
  - item
  - itemset
  - itemsize
  - lcm
  - ldexp
  - le
  - lerp
  - less
  - less_equal
  - log
  - log10
  - log1p
  - log2
  - logaddexp
  - logaddexp2
  - logdet
  - logical_and
  - logical_not
  - logical_or
  - logical_xor
  - log_normal
  - logit
  - logsumexp
  - long
  - lt
  - lu_solve
  - masked_fill
  - masked_scatter
  - masked_select
  - matmul
  - max
  - maximum
  - mean
  - median
  - min
  - minimum
  - moveaxis
  - movedim
  - msort
  - multinomial
  - multiply
  - mvlgamma
  - nan_to_num
  - nanmean
  - nanmedian
  - nbytes
  - ndim
  - ndimension
  - nansum
  - narrow
  - ne
  - neg
  - negative
  - nelement
  - new_ones
  - new_zeros
  - nextafter
  - numel
  - norm
  - nonzero
  - not_equal
  - outer
  - orgqr
  - ormqr
  - permute
  - positive
  - pow
  - prod
  - qr
  - ravel
  - real
  - reciprocal
  - remainder
  - renorm
  - rad2deg
  - tile
  - repeat
  - repeat_interleave
  - reshape
  - reshape_as
  - round
  - rot90
  - rsqrt
  - sum_to_size
  - scatter
  - scatter_add
  - scatter_div
  - scatter_max
  - scatter_min
  - scatter_mul
  - scatter_sub
  - searchsorted
  - select
  - select_scatter
  - sgn
  - short
  - sigmoid
  - sign
  - signbit
  - sin
  - sinc
  - sinh
  - size
  - slice_scatter
  - slogdet
  - softmax
  - sort
  - split
  - sqrt
  - square
  - squeeze
  - std
  - sub
  - subtract
  - svd
  - swapaxes
  - swapdims
  - t
  - take
  - tan
  - tanh
  - trace
  - swapaxes
  - tile
  - to
  - topk
  - tril
  - triu
  - tensor_split
  - transpose
  - true_divide
  - trunc
  - unfold
  - uniform
  - unbind
  - unique_consecutive
  - unique_with_pad
  - unsorted_segment_max
  - unsorted_segment_min
  - unsorted_segment_prod
  - unsqueeze
  - var
  - view
  - vsplit
  - where
  - xlogy
  - xdivy
  - from_numpy
  - std
  - take
  - var
  - all
  - any
  - copy
  - diagonal
  - diagonal_scatter
  - flatten
  - resize
  - reverse
  - reverse_sequence
  - roll
  - sum

nn:
  - Conv1d
  - Conv1dTranspose
  - Conv2d
  - Conv2dTranspose
  - Conv3d
  - Conv3dTranspose
  - Unfold
  - RNN
  - RNNCell
  - GRU
  - GRUCell
  - LSTM
  - LSTMCell
  - MultiheadAttention
  - TransformerEncoderLayer
  - TransformerDecoderLayer
  - TransformerEncoder
  - TransformerDecoder
  - Transformer
  - Embedding
  - EmbeddingLookup
  - MultiFieldEmbeddingLookup
  - CELU
  - ELU
  - FastGelu
  - GELU
  - GLU
  - get_activation
  - Hardtanh
  - HShrink
  - HSigmoid
  - HSwish
  - LeakyReLU
  - LogSigmoid
  - LogSoftmax
  - LRN
  - Mish
  - Softsign
  - PReLU
  - ReLU
  - ReLU6
  - RReLU
  - SeLU
  - SiLU
  - Sigmoid
  - Softmin
  - Softmax
  - Softmax2d
  - SoftShrink
  - Tanh
  - Tanhshrink
  - Threshold
  - Dense
  - BiDense
  - Dropout
  - Dropout1d
  - Dropout2d
  - Dropout3d
  - BatchNorm1d
  - BatchNorm2d
  - BatchNorm3d
  - GroupNorm
  - InstanceNorm1d
  - InstanceNorm2d
  - InstanceNorm3d
  - LayerNorm
  - SyncBatchNorm
  - AdaptiveAvgPool1d
  - AdaptiveAvgPool2d
  - AdaptiveAvgPool3d
  - AdaptiveMaxPool1d
  - AdaptiveMaxPool2d
  - AdaptiveMaxPool3d
  - AvgPool1d
  - AvgPool2d
  - AvgPool3d
  - FractionalMaxPool3d
  - LPPool1d
  - LPPool2d
  - MaxPool1d
  - MaxPool2d
  - MaxPool3d
  - MaxUnpool1d
  - MaxUnpool2d
  - MaxUnpool3d
  - Pad
  - ConstantPad1d
  - ConstantPad2d
  - ConstantPad3d
  - ReflectionPad1d
  - ReflectionPad2d
  - ReflectionPad3d
  - ReplicationPad1d
  - ReplicationPad2d
  - ReplicationPad3d
  - ZeroPad2d
  - BCELoss
  - BCEWithLogitsLoss
  - CosineEmbeddingLoss
  - CrossEntropyLoss
  - CTCLoss
  - DiceLoss
  - FocalLoss
  - GaussianNLLLoss
  - HingeEmbeddingLoss
  - HuberLoss
  - KLDivLoss
  - L1Loss
  - MarginRankingLoss
  - MSELoss
  - MultiClassDiceLoss
  - MultilabelMarginLoss
  - MultiLabelSoftMarginLoss
  - MultiMarginLoss
  - NLLLoss
  - PoissonNLLLoss
  - RMSELoss
  - SampledSoftmaxLoss
  - SmoothL1Loss
  - SoftMarginLoss
  - SoftmaxCrossEntropyWithLogits
  - TripletMarginLoss
  - PixelShuffle
  - PixelUnshuffle
  - ResizeBilinear
  - Upsample
  - ChannelShuffle
  - Flatten
  - Identity
  - Unflatten

mint.ops:
  - abs
  - absolute_import
  - add
  - all
  - any
  - arange
  - argmax
  - avg_pool2d
  - baddbmm
  - batch_norm
  - binary_cross_entropy_with_logits
  - bitwise_and
  - bitwise_or
  - bitwise_xor
  - bmm
  - inverse
  - broadcast_to
  - cat
  - cat_ex
  - ceil
  - chunk
  - clamp
  - atan2
  - arctan2
  - conv2d
  - conv_transpose2d
  - cos
  - cross
  - cummax
  - cummin
  - cumsum
  - div
  - divide
  - dropout
  - embedding
  - eq
  - erf
  - erfinv
  - exp
  - floor
  - flatten
  - flip
  - fold
  - full
  - functional
  - gather
  - gelu
  - greater
  - greater_equal
  - grid_sample
  - group_norm
  - gt
  - index_select
  - interpolate
  - isclose
  - isfinite
  - layer_norm
  - le
  - leaky_relu
  - less
  - less_equal
  - linear
  - linspace
  - log
  - logical_and
  - logical_not
  - logical_or
  - lt
  - masked_select
  - matmul
  - max
  - max_pool2d
  - maximum
  - mean
  - min
  - minimum
  - mul
  - ne
  - neg
  - negative
  - nn
  - nonzero
  - normal
  - one_hot
  - ones
  - ones_ex
  - ones_like
  - pad
  - permute
  - permute_ex
  - pow
  - prod
  - reciprocal
  - relu
  - remainder
  - repeat_interleave
  - rsqrt
  - scatter
  - scatter_add
  - searchsorted
  - sigmoid
  - silu
  - sin
  - softmax
  - softplus
  - sort
  - split
  - sqrt
  - square
  - stack
  - sub
  - sub_ex
  - sum
  - tanh
  - tile
  - topk
  - tril
  - triu
  - unfold
  - unique
  - where
  - xlogy
  - zeros
  - zeros_ex
  - zeros_like

mint.nn:
  - Dropout
  - Embedding
  - Fold
  - LayerNorm
  - Linear
  - MaxPool2d
  - Unfold
  - Upsample

mint.nn.functional:
  - absolute_import
  - avg_pool2d
  - batch_norm
  - bce_with_logits
  - binary_cross_entropy
  - binary_cross_entropy_with_logits
  - conv_transpose2d
  - dense
  - dropout
  - embedding
  - fold
  - elu
  - gelu
  - grid_sample
  - group_norm
  - interpolate
  - layer_norm
  - leaky_relu
  - linear
  - max_pool2d
  - normal
  - one_hot
  - one_hot_ext
  - pad
  - relu
  - sigmoid
  - silu
  - softmax
  - softplus
  - tanh
  - unfold
